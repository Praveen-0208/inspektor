syntax = "proto3";

package api;
option go_package = "controlplane/apiproto";

message AuthRequest {
    string password = 1;
}

message Empty {
}

message DataSourceResponse {
    string data_source_name = 1;
}

message InspektorPolicy {
    bytes wasm_byte_code = 1;
}

service Inspektor {
    rpc Auth(AuthRequest) returns (Empty) {}
    rpc Policy(Empty) returns (stream InspektorPolicy){}
    rpc GetDataSource(Empty) returns (DataSourceResponse) {}
}